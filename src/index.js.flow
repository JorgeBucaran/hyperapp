declare module "hyperapp" {
  declare type VirtualNode = {
    tag: string,
    data: { [string]: any },
    children: Array<VirtualNode | string>
  };

  declare type Emit = (event: string, data: any) => any;

  declare type Thunk = () => { [string]: any };
  declare type ActionResult = { [string]: any } | Thunk;
  declare type Action = (
    state: { [string]: any },
    actions: { [string]: Action },
    data?: any
  ) => ActionResult;
  declare type Actions = { [string]: Action };

  declare type Event = (
    state: { [string]: any },
    actions: Actions,
    data?: any
  ) => { [string]: any };
  declare type Events = { [string]: Event };

  declare type View = (
    state: { [string]: any },
    actions: Actions
  ) => VirtualNode;

  declare type Mixin = (
    emit: Emit
  ) => {
    state?: { [string]: any },
    actions?: Actions,
    events?: Events,
    mixins?: Array<Mixin>
  };

  declare type VirtualComponent = (
    data: { [string]: any } | null,
    children: Array<VirtualNode | string> | VirtualNode | string
  ) => VirtualNode;

  declare exports function h(tag: VirtualComponent | string, data: any): VirtualNode;
  declare exports function app(
    props: {
      root?: HTMLElement, 
      state: { [string]: any },
      view?: View,
      actions?: Actions,
      events?: Events,
      mixins?: Array<Mixin>
    }): Emit;
}
