{"version":3,"sources":["dist/hyperapp.js"],"names":["global","factory","exports","module","define","amd","hyperapp","this","h","type","props","node","stack","children","i","arguments","length","push","Array","isArray","pop","app","container","vnode","element","map","tagName","toLowerCase","call","childNodes","nodeType","nodeValue","set","to","from","merge","setDeep","path","value","slice","get","isFunction","any","init","state","actions","key","action","data","appState","then","repaint","concat","getKey","setElementProp","name","oldValue","style","_","removeAttribute","setAttribute","createElement","ns","document","createTextNode","namespaces","namespace","xhtml","createElementNS","oncreate","lifecycle","appendChild","removeElement","parent","done","removeChild","onremove","patch","oldNode","nextSibling","insertBefore","oldProps","onupdate","updateElement","namespaceURI","len","oldLen","oldKeyed","oldElements","keyed","oldElement","oldKey","oldChild","j","newChild","newKey","keyedNode","reusableNode","render","next","lock","view","appActions","root","setTimeout","body","svg"],"mappings":"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","sourcesContent":["(function (global, factory) {\n\ttypeof exports === 'object' && typeof module !== 'undefined' ? factory(exports) :\n\ttypeof define === 'function' && define.amd ? define(['exports'], factory) :\n\t(factory((global.hyperapp = {})));\n}(this, (function (exports) { 'use strict';\n\nfunction h(type, props) {\n  var node;\n  var stack = [];\n  var children = [];\n\n  for (var i = arguments.length; i-- > 2; ) {\n    stack.push(arguments[i]);\n  }\n\n  while (stack.length) {\n    if (Array.isArray((node = stack.pop()))) {\n      for (i = node.length; i--; ) {\n        stack.push(node[i]);\n      }\n    } else if (null == node || node === true || node === false) {\n    } else {\n      children.push(typeof node === \"number\" ? (node = node + \"\") : node);\n    }\n  }\n\n  return typeof type === \"string\"\n    ? {\n        type: type,\n        props: props || {},\n        children: children\n      }\n    : type(props || {}, children)\n}\n\nfunction app(props, container) {\n  var lock;\n  var root = (container = container || document.body).children[0];\n  var node = vnode(root, [].map);\n  var lifecycle = [];\n  var appState = props.state || {};\n  var appActions = {};\n  var namespaces = {\n    svg: \"http://www.w3.org/2000/svg\",\n    xhtml: \"http://www.w3.org/1999/xhtml\"\n  };\n\n  repaint(init(appState, appActions, props.actions, []));\n\n  return appActions\n\n  function vnode(element, map) {\n    return (\n      element &&\n      h(\n        element.tagName.toLowerCase(),\n        {},\n        map.call(element.childNodes, function(element) {\n          return element.nodeType === 3\n            ? element.nodeValue\n            : vnode(element, map)\n        })\n      )\n    )\n  }\n\n  function set(to, from) {\n    for (var i in from) {\n      to[i] = from[i];\n    }\n    return to\n  }\n\n  function merge(to, from) {\n    return set(set({}, to), from)\n  }\n\n  function setDeep(path, value, from) {\n    var to = {};\n    return 0 === path.length\n      ? value\n      : (to[path[0]] =\n          1 < path.length\n            ? setDeep(path.slice(1), value, from[path[0]])\n            : value, merge(from, to))\n  }\n\n  function get(path, from) {\n    for (var i = 0; i < path.length; i++) {\n      from = from[path[i]];\n    }\n    return from\n  }\n\n  function isFunction(any) {\n    return \"function\" === typeof any\n  }\n\n  function init(state, actions, from, path) {\n    for (var key in from) {\n      isFunction(from[key])\n        ? (function(key, action) {\n            actions[key] = function(data) {\n              state = get(path, appState);\n\n              if (\n                isFunction((data = action(data))) &&\n                isFunction((data = data(state)))\n              ) {\n                data = data(actions);\n              }\n\n              if (data && data !== state && !data.then) {\n                repaint(\n                  (appState = setDeep(path, merge(state, data), appState))\n                );\n              }\n\n              return data\n            };\n          })(key, from[key])\n        : init(\n            state[key] || (state[key] = {}),\n            (actions[key] = {}),\n            from[key],\n            path.concat(key)\n          );\n    }\n  }\n\n  function getKey(node) {\n    if (node && node.props) {\n      return node.props.key\n    }\n  }\n\n  function setElementProp(element, name, value, oldValue) {\n    if (name === \"key\") {\n    } else if (name === \"style\") {\n      for (var i in merge(oldValue, (value = value || {}))) {\n        element.style[i] = null == value[i] ? \"\" : value[i];\n      }\n    } else if (name!==\"namespace\") {\n      try {\n        element[name] = null == value ? \"\" : value;\n      } catch (_) {}\n\n      if (!isFunction(value)) {\n        if (null == value || false === value) {\n          element.removeAttribute(name);\n        } else {\n          element.setAttribute(name, value);\n        }\n      }\n    }\n  }\n\n  function createElement(node, ns) {\n    if (typeof node === \"string\") {\n      var element = document.createTextNode(node);\n    } else {\n      ns =\n        namespaces[node.type] || node.props.namespace || ns || namespaces.xhtml;\n      var element = document.createElementNS(ns, node.type);\n      if (node.props.oncreate) {\n        lifecycle.push(function() {\n          node.props.oncreate(element);\n        });\n      }\n\n      for (var i = 0; i < node.children.length; i++) {\n        element.appendChild(createElement(node.children[i], ns));\n      }\n\n      for (var i in node.props) {\n        setElementProp(element, i, node.props[i]);\n      }\n    }\n    return element\n  }\n\n  function updateElement(element, oldProps, props) {\n    for (var i in merge(oldProps, props)) {\n      var value = props[i];\n      var oldValue = i === \"value\" || i === \"checked\" ? element[i] : oldProps[i];\n\n      if (value !== oldValue) {\n        setElementProp(element, i, value, oldValue);\n      }\n    }\n\n    if (props.onupdate) {\n      lifecycle.push(function() {\n        props.onupdate(element, oldProps);\n      });\n    }\n  }\n\n  function removeElement(parent, element, props) {\n    function done() {\n      parent.removeChild(element);\n    }\n\n    if (props && props.onremove) {\n      props.onremove(element, done);\n    } else {\n      done();\n    }\n  }\n\n  function patch(parent, element, oldNode, node, ns, nextSibling) {\n    if (oldNode === node) {\n    } else if (null == oldNode) {\n      element = parent.insertBefore(createElement(node, ns), element);\n    } else if (node.type != null && node.type === oldNode.type) {\n      updateElement(element, oldNode.props, node.props);\n\n      ns = element.namespaceURI || namespaces.xhtml;\n\n      var len = node.children.length;\n      var oldLen = oldNode.children.length;\n      var oldKeyed = {};\n      var oldElements = [];\n      var keyed = {};\n\n      for (var i = 0; i < oldLen; i++) {\n        var oldElement = (oldElements[i] = element.childNodes[i]);\n        var oldChild = oldNode.children[i];\n        var oldKey = getKey(oldChild);\n\n        if (null != oldKey) {\n          oldKeyed[oldKey] = [oldElement, oldChild];\n        }\n      }\n\n      var i = 0;\n      var j = 0;\n\n      while (j < len) {\n        var oldElement = oldElements[i];\n        var oldChild = oldNode.children[i];\n        var newChild = node.children[j];\n\n        var oldKey = getKey(oldChild);\n        if (keyed[oldKey]) {\n          i++;\n          continue\n        }\n\n        var newKey = getKey(newChild);\n        var keyedNode = oldKeyed[newKey] || [];\n\n        if (null == newKey) {\n          if (null == oldKey) {\n            patch(element, oldElement, oldChild, newChild, ns);\n            j++;\n          }\n          i++;\n        } else {\n          if (oldKey === newKey) {\n            patch(element, keyedNode[0], keyedNode[1], newChild, ns);\n            i++;\n          } else if (keyedNode[0]) {\n            element.insertBefore(keyedNode[0], oldElement);\n            patch(element, keyedNode[0], keyedNode[1], newChild, ns);\n          } else {\n            patch(element, oldElement, null, newChild, ns);\n          }\n\n          j++;\n          keyed[newKey] = newChild;\n        }\n      }\n\n      while (i < oldLen) {\n        var oldChild = oldNode.children[i];\n        var oldKey = getKey(oldChild);\n        if (null == oldKey) {\n          removeElement(element, oldElements[i], oldChild.props);\n        }\n        i++;\n      }\n\n      for (var i in oldKeyed) {\n        var keyedNode = oldKeyed[i];\n        var reusableNode = keyedNode[1];\n        if (!keyed[reusableNode.props.key]) {\n          removeElement(element, keyedNode[0], reusableNode.props);\n        }\n      }\n    } else if (element && node !== element.nodeValue) {\n      if (typeof node === \"string\" && typeof oldNode === \"string\") {\n        element.nodeValue = node;\n      } else {\n        element = parent.insertBefore(\n          createElement(node, ns),\n          (nextSibling = element)\n        );\n        removeElement(parent, nextSibling, oldNode.props);\n      }\n    }\n\n    return element\n  }\n\n  function render(next) {\n    lock = !lock;\n\n    if (isFunction((next = props.view(appState)))) {\n      next = next(appActions);\n    }\n\n    if (!lock) {\n      root = patch(container, root, node, (node = next));\n    }\n\n    while ((next = lifecycle.pop())) next();\n  }\n\n  function repaint() {\n    if (props.view && !lock) {\n      setTimeout(render, (lock = !lock));\n    }\n  }\n}\n\nexports.h = h;\nexports.app = app;\n\nObject.defineProperty(exports, '__esModule', { value: true });\n\n})));\n//# sourceMappingURL=hyperapp.js.map\n"]}